<%- include ('./navbar.ejs') %>

  <title>My Cart | Fika</title>
  <meta name="description" content="My Cart | Fika">

  <main style="background:#ffffff;padding:24px 0;font-family:Inter,system-ui;margin-top:80px;margin-bottom: 80px;">

    <div class="container">

      <h2 style="font-size:22px;font-weight:700;margin-bottom:24px">Your Shopping Cart</h2>

      <div class="row g-4">

        <div class="col-12 col-lg-7">

          <% let subtotal=Number(cartData.totalPrice) || 0; let shipping=100; let tax=Math.round(subtotal * 0.18); let
            orderTotal=subtotal + shipping + tax; for(let i=0;i<cartData.cartItems.length;i++){ let
            item=cartData.cartItems[i]; let itemTotal=Number(item.oneprice) * Number(item.quantity); %>

            <div
              style="border:1px solid #e5e7eb;border-radius:12px;padding:14px;display:flex;gap:14px;align-items:center;margin-bottom:14px;flex-wrap:wrap">

              <img src="/images/<%=item.bookingimage%>"
                style="width:64px;height:64px;border-radius:8px;object-fit:cover">

              <div style="flex:1;min-width:200px">

                <div style="font-size:14px;font-weight:600;color:#111827;margin-bottom:4px">
                  <%= (item.bookingname || '' ).replace(/"/g,'') %>
                </div>

                <div style="display:flex;align-items:center;gap:8px;margin-bottom:6px">
                  <span style="font-size:14px;font-weight:700;color:#2563eb">Rs. <%=item.oneprice%></span>
                  <span style="font-size:12px;color:#9ca3af;text-decoration:line-through">Rs. <%=item.price%></span>
                </div>

                <div style="display:flex;align-items:center;gap:6px">
                  <button onclick="addToCart1('<%=item.booking_id%>','-1','<%=item.quantity%>')"
                    style="width:26px;height:26px;border:1px solid #d1d5db;background:#fff;border-radius:6px">‚àí</button>

                  <input value="<%=item.quantity%>" readonly
                    style="width:34px;height:26px;border:1px solid #d1d5db;border-radius:6px;text-align:center;font-size:13px">

                  <button onclick="addToCart1('<%=item.booking_id%>','+1','<%=item.quantity%>')"
                    style="width:26px;height:26px;border:1px solid #d1d5db;background:#fff;border-radius:6px">+</button>
                </div>

              </div>

              <div style="display:flex;flex-direction:column;align-items:flex-end;gap:10px;margin-left:auto">
                <div style="font-size:14px;font-weight:600">Rs. <%=itemTotal%>
                </div>
                <button onclick="addToCart1('<%=item.booking_id%>','0','0')"
                  style="border:none;background:none;cursor:pointer;font-size:16px">üóë</button>
              </div>

            </div>

            <% } %>

              <a href="/"
                style="display:inline-block;margin-top:10px;font-size:14px;color:#2563eb;text-decoration:none">
                ‚Üê Continue Shopping
              </a>

        </div>

        <div class="col-12 col-lg-5">

          <div style="border:1px solid #e5e7eb;border-radius:14px;padding:18px;position:sticky;top:90px">

            <div style="font-size:16px;font-weight:700;margin-bottom:16px">Order Summary</div>

            <div style="display:flex;justify-content:space-between;font-size:14px;margin-bottom:8px">
              <span>Subtotal</span>
              <span>Rs. <%=subtotal%></span>
            </div>

            <div style="display:flex;justify-content:space-between;font-size:14px;margin-bottom:8px">
              <span>Shipping</span>
              <span>Rs. <%=shipping%></span>
            </div>

            <div style="display:flex;justify-content:space-between;font-size:14px;margin-bottom:12px">
              <span>Tax (18%)</span>
              <span>Rs. <%=tax%></span>
            </div>

            <hr>

            <div style="display:flex;justify-content:space-between;font-size:16px;font-weight:700;margin-bottom:14px">
              <span>Order Total</span>
              <span>Rs. <%=orderTotal%></span>
            </div>

            <div style="display:flex;gap:10px;align-items:center;margin-bottom:14px">

              <input id="couponInput" placeholder="Coupon Code" oninput="toggleCouponBtn()" style="
      flex:1;
      height:44px;
      border:2px solid #d1d5db;
      border-radius:12px;
      padding:0 14px;
      font-size:15px;
      outline:none;
    ">

              <button id="applyCouponBtn" style="
      height:44px;
      padding:0 22px;
      border-radius:12px;
      border:none;
      background:#1d4ed8;
      color:#fff;
      font-size:15px;
      font-weight:600;
      display:none;
      white-space:nowrap;
      cursor:pointer;
    ">
                Apply
              </button>

            </div>


            <a href="/checkout"
              style="display:block;text-align:center;background:#2563eb;color:#fff;border-radius:10px;padding:12px;font-weight:600;text-decoration:none">
              Proceed to Checkout
            </a>

          </div>

        </div>

      </div>
    </div>

  </main>
  <script>
    function toggleCouponBtn() {
      const input = document.getElementById('couponInput');
      const btn = document.getElementById('applyCouponBtn');
      btn.style.display = input.value.trim() ? 'block' : 'none';
    }
  </script>
  <%- include ('./footer1.ejs') %>
    <%- include ('./footer.ejs') %>